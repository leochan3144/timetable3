<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>My Class Dashboard</title>
    <style>
        :root {
            --bg-color: #F2F2F7;
            --card-bg: #FFFFFF;
            --primary: #007AFF;
            --text-main: #000000;
            --text-sub: #8E8E93;
            --red: #FF3B30;
            --green: #34C759;
            --yellow: #FF9500;
            --blue: #007AFF;
            --purple: #AF52DE;
            --gray: #8E8E93;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }

        .app-container { display: flex; flex-direction: column; height: 100vh; }

        header { padding: 10px 20px; background: var(--bg-color); }
        .clock { font-size: 2.8rem; font-weight: 800; letter-spacing: -0.03em; }
        
        /* Special Toggle */
        .mode-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #E5E5EA;
            padding: 8px 15px;
            border-radius: 12px;
            margin-bottom: 10px;
        }
        .mode-toggle span { font-weight: 600; font-size: 0.9rem; }
        .switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 24px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc; transition: .4s; border-radius: 24px;
        }
        .slider:before {
            position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px;
            background-color: white; transition: .4s; border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--purple); }
        input:checked + .slider:before { transform: translateX(20px); }

        .day-scroller {
            display: flex; overflow-x: auto; gap: 10px; padding: 10px 20px;
            background: var(--bg-color); position: sticky; top: 0; z-index: 10;
        }
        .day-btn {
            flex: 0 0 auto; background: #E5E5EA; border: none; padding: 8px 18px;
            border-radius: 18px; font-weight: 600;
        }
        .day-btn.active { background: var(--text-main); color: #FFF; }

        .content-area { flex: 1; overflow-y: auto; padding: 20px; }
        .card { background: var(--card-bg); border-radius: 22px; padding: 20px; margin-bottom: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.03); }
        .card-label { text-transform: uppercase; font-size: 0.7rem; font-weight: 700; color: var(--text-sub); margin-bottom: 5px; }
        .lesson-title { font-size: 1.5rem; font-weight: 700; }
        
        .progress-track { background: #E5E5EA; height: 6px; border-radius: 10px; margin-top: 15px; overflow: hidden; }
        .progress-fill { height: 100%; width: 0%; transition: width 1s linear; }

        .next-card { display: flex; align-items: center; gap: 12px; padding: 12px 18px; }
        .next-ind { width: 4px; height: 30px; border-radius: 4px; background: var(--text-sub); }

        .list-container { background: var(--card-bg); border-radius: 20px; overflow: hidden; margin-top: 10px; }
        .list-item { display: grid; grid-template-columns: 85px 70px 1fr; padding: 12px; border-bottom: 1px solid #F2F2F7; font-size: 0.85rem; }
        .active-row { background-color: #F0F8FF; font-weight: bold; }

        .subj-red { color: var(--red); } .subj-green { color: var(--green); }
        .subj-yellow { color: var(--yellow); } .subj-blue { color: var(--blue); }
        .subj-break { color: var(--purple); font-style: italic; }
        .subj-free { color: var(--gray); opacity: 0.5; }
    </style>
</head>
<body>

<div class="app-container">
    <header>
        <div class="mode-toggle">
            <span>Special Timetable</span>
            <label class="switch">
                <input type="checkbox" id="specialToggle">
                <span class="slider"></span>
            </label>
        </div>
        <div class="clock" id="clock">00:00</div>
    </header>

    <div class="day-scroller" id="daySelector"></div>

    <div class="content-area">
        <div class="card">
            <div class="card-label">Now</div>
            <div class="lesson-title" id="currentTitle">Loading...</div>
            <div class="progress-track"><div class="progress-fill" id="progressBar"></div></div>
        </div>

        <div class="card next-card">
            <div class="next-ind" id="nextIndicator"></div>
            <div>
                <div class="card-label">Next</div>
                <div id="nextTitle" style="font-weight:700;">--</div>
            </div>
        </div>

        <h3 style="margin-left:5px; font-size:1.1rem;">Full Schedule</h3>
        <div class="list-container" id="listContainer"></div>
    </div>
</div>

<script>
    const normalSlots = [
        { s: "08:00", e: "08:25", type: "period", label: "Class Period" },
        { s: "08:25", e: "09:00", type: "slot", id: 1 },
        { s: "09:00", e: "09:35", type: "slot", id: 2 },
        { s: "09:35", e: "09:55", type: "break", label: "Recess" },
        { s: "09:55", e: "10:30", type: "slot", id: 3 },
        { s: "10:30", e: "11:05", type: "slot", id: 4 },
        { s: "11:05", e: "11:25", type: "break", label: "Recess" },
        { s: "11:25", e: "12:00", type: "slot", id: 5 },
        { s: "12:00", e: "12:35", type: "slot", id: 6 },
        { s: "12:35", e: "13:45", type: "break", label: "Lunch" },
        { s: "13:45", e: "13:50", type: "period", label: "Roll Call" },
        { s: "13:50", e: "14:25", type: "slot", id: 7 },
        { s: "14:25", e: "15:00", type: "slot", id: 8 },
        { s: "15:00", e: "15:35", type: "slot", id: 9 }
    ];

    const specialSlots = [
        { s: "08:00", e: "08:15", type: "period", label: "Class Period" },
        { s: "08:15", e: "08:45", type: "slot", id: 1 },
        { s: "08:45", e: "09:15", type: "slot", id: 2 },
        { s: "09:15", e: "09:30", type: "break", label: "Recess" },
        { s: "09:30", e: "10:00", type: "slot", id: 3 },
        { s: "10:00", e: "10:30", type: "slot", id: 4 },
        { s: "10:30", e: "10:45", type: "break", label: "Recess" },
        { s: "10:45", e: "11:15", type: "slot", id: 5 },
        { s: "11:15", e: "11:45", type: "slot", id: 6 },
        { s: "11:45", e: "12:00", type: "break", label: "Recess" },
        { s: "12:00", e: "12:30", type: "slot", id: 7 },
        { s: "12:30", e: "13:00", type: "slot", id: 8 }
    ];

    const scheduleData = {
        1: { 1: "4C,4D MAM1 (304)", 2: "4C,4D MAM1 (304)", 4: "1C MATH (103)", 5: "5C MACO (403)", 7: "4D MACO (304)" },
        2: { 1: "4D MACO (304)", 6: "5C MACO (403)", 7: "1C MATH (103)", 9: "1A...1D IS" },
        3: { 2: "4D MACO (304)", 5: "5C MACO (403)", 7: "1C MATH (103)", 8: "1C MATH (103)" },
        4: { 1: "1C MATH (103)", 4: "5C MACO (403)", 5: "5C MACO (403)", 7: "4D MACO (304)" },
        5: { 3: "1C MATH (103)", 4: "5C MACO (403)", 6: "4D MACO (304)" },
        6: { 1: "4C,4D MAM1 (304)", 2: "4C,4D MAM1 (304)", 3: "1C MATH (103)", 5: "4D MACO (304)" }
    };

    let selectedDay = 1;
    let isSpecial = false;

    function parseTime(t) { const [h, m] = t.split(':').map(Number); return h * 60 + m; }

    function getColor(name, type) {
        if (type === 'break' || name === 'Class Period' || name === 'Roll Call') return 'purple';
        if (!name || name === 'Free Period') return 'free';
        if (name.includes("MAM1")) return "red";
        if (name.includes("MATH")) return "green";
        if (name.includes("5C MACO")) return "yellow";
        if (name.includes("4D MACO")) return "blue";
        return "black";
    }

    function render() {
        const now = new Date();
        document.getElementById('clock').innerText = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit', hour12: false});
        const curMin = now.getHours() * 60 + now.getMinutes();
        const activeSlots = isSpecial ? specialSlots : normalSlots;

        let dayList = activeSlots.map(s => {
            let name = (s.type === 'slot') ? (scheduleData[selectedDay][s.id] || "Free Period") : s.label;
            return { ...s, name, sMin: parseTime(s.s), eMin: parseTime(s.e) };
        });

        let cur = dayList.find(s => curMin >= s.sMin && curMin < s.eMin);
        let nxt = dayList.find(s => s.sMin > curMin);

        // UI Updates
        const title = document.getElementById('currentTitle');
        const bar = document.getElementById('progressBar');
        if (cur) {
            title.innerText = cur.name;
            title.className = "lesson-title subj-" + getColor(cur.name, cur.type);
            bar.style.width = ((curMin - cur.sMin) / (cur.eMin - cur.sMin) * 100) + "%";
            bar.style.backgroundColor = `var(--${getColor(cur.name, cur.type)})`;
        } else {
            title.innerText = curMin < dayList[0].sMin ? "Before School" : "School Over";
            bar.style.width = "0%";
        }

        document.getElementById('nextTitle').innerText = nxt ? nxt.name : "None";
        document.getElementById('nextIndicator').style.backgroundColor = nxt ? `var(--${getColor(nxt.name, nxt.type)})` : "#ccc";

        let html = "";
        dayList.forEach(s => {
            const active = (cur && cur.s === s.s) ? "active-row" : "";
            html += `<div class="list-item ${active}">
                <span>${s.s}-${s.e}</span>
                <span style="color:#8E8E93">${s.id ? 'Lesson '+s.id : ''}</span>
                <span class="subj-${getColor(s.name, s.type)}">${s.name}</span>
            </div>`;
        });
        document.getElementById('listContainer').innerHTML = html;
    }

    document.getElementById('specialToggle').onchange = (e) => { isSpecial = e.target.checked; render(); };

    const ds = document.getElementById('daySelector');
    for(let i=1; i<=6; i++){
        const b = document.createElement('button'); b.className = `day-btn ${i===1?'active':''}`; b.innerText = "Day "+i;
        b.onclick = () => { document.querySelectorAll('.day-btn').forEach(x=>x.classList.remove('active')); b.classList.add('active'); selectedDay=i; render(); };
        ds.appendChild(b);
    }
    setInterval(render, 1000); render();
</script>
</body>
</html>
